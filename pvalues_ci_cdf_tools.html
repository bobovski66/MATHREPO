<!-- File 1: p-values with shaded area and tail choices -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>p-value Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jstat/1.9.5/jstat.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f7f7f7; }
    input, select { margin: 0.5em; }
    .result { font-weight: bold; margin-top: 1em; }
  </style>
</head>
<body>
  <h2>p-value Calculator (z or t)</h2>
  <label>Distribution: 
    <select id="dist">
      <option value="z">Standard Normal (z)</option>
      <option value="t">Student's t</option>
    </select>
  </label>
  <label>Tail: 
    <select id="tail">
      <option value="left">Left</option>
      <option value="right">Right</option>
      <option value="two">Two-tailed</option>
    </select>
  </label>
  <label>Value:
    <input type="number" id="stat" step="any">
  </label>
  <label id="dfLabel" style="display:none;">df: <input type="number" id="df" step="1"></label>
  <button onclick="computeP()">Compute</button>
  <div class="result" id="result"></div>
  <canvas id="plot" width="600" height="300"></canvas>

<script>
  const distSel = document.getElementById('dist');
  const dfLabel = document.getElementById('dfLabel');
  distSel.onchange = () => dfLabel.style.display = distSel.value === 't' ? 'inline-block' : 'none';

  let chart;

  function computeP() {
    const stat = parseFloat(document.getElementById('stat').value);
    const tail = document.getElementById('tail').value;
    const dist = distSel.value;
    const df = parseInt(document.getElementById('df').value);
    let p;
    if (dist === 'z') {
      if (tail === 'left') p = jStat.normal.cdf(stat, 0, 1);
      if (tail === 'right') p = 1 - jStat.normal.cdf(stat, 0, 1);
      if (tail === 'two') p = 2 * (1 - jStat.normal.cdf(Math.abs(stat), 0, 1));
    } else {
      if (tail === 'left') p = jStat.studentt.cdf(stat, df);
      if (tail === 'right') p = 1 - jStat.studentt.cdf(stat, df);
      if (tail === 'two') p = 2 * (1 - jStat.studentt.cdf(Math.abs(stat), df));
    }
    document.getElementById('result').textContent = `p = ${p.toFixed(6)}`;
    drawShading(stat, tail, dist, df);
  }

  function drawShading(stat, tail, dist, df) {
    const ctx = document.getElementById('plot').getContext('2d');
    if (chart) chart.destroy();
    const x = [], y = [], bg = [];
    const min = -5, max = 5;
    for (let i = min; i <= max; i += 0.1) {
      x.push(i);
      const pdf = dist === 'z' ? jStat.normal.pdf(i, 0, 1) : jStat.studentt.pdf(i, df);
      y.push(pdf);
      if (tail === 'left') bg.push(i <= stat ? 'rgba(52,152,219,0.4)' : 'rgba(0,0,0,0)');
      else if (tail === 'right') bg.push(i >= stat ? 'rgba(231,76,60,0.4)' : 'rgba(0,0,0,0)');
      else if (tail === 'two') bg.push(Math.abs(i) >= Math.abs(stat) ? 'rgba(241,196,15,0.5)' : 'rgba(0,0,0,0)');
    }
    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: x,
        datasets: [{ label: 'PDF', data: y, backgroundColor: bg, borderWidth: 1 }]
      },
      options: {
        scales: { x: { ticks: { callback: v => +v.toFixed(1) } }, y: { beginAtZero: true } },
        plugins: { legend: { display: false } }
      }
    });
  }
</script>
</body>
</html>
